(self.webpackChunk=self.webpackChunk||[]).push([[815],{72190:function(R,$,n){"use strict";n.r($),n.d($,{default:function(){return va}});var g=n(62435),x=n(35312),M=n(21612),S=n(86250),L=n(21906),ye=n(97857),Z=n.n(ye),Ce=n(13769),J=n.n(Ce),K=n(63764),Q=n(57953),re=n(19093),e=n(86074),je=["className","options"];K._m.config({monaco:re});var Ee={fontSize:14,fontFamily:"Menlo, Monaco, 'Courier New', monospace",contextmenu:!1,readOnly:!0,hideUnchangedRegions:{enabled:!0,minimumLineCount:1,contextLineCount:3},scrollbar:{verticalScrollbarSize:0,horizontalScrollbarSize:0}};function Se(t){var u=t.className,s=t.options,a=J()(t,je);return(0,e.jsx)(K.SV,Z()({loading:(0,e.jsx)(Q.Z,{}),className:u,language:"html",options:Z()(Z()({},Ee),s)},a))}var Ze=n(15009),P=n.n(Ze),Fe=n(99289),U=n.n(Fe),Ne=["options","readOnly","onMount","onSave"];K._m.config({monaco:re,"vs/nls":{availableLanguages:{"*":"cn"}}});function Ae(t){var u=t.options,s=t.readOnly,a=s===void 0?!1:s,i=t.onMount,r=t.onSave,l=J()(t,Ne),o=(0,K.Ik)(),f=(0,g.useRef)(void 0);(0,g.useEffect)(function(){var p=function(h){var d="\u4F60\u786E\u5B9A\u8981\u79BB\u5F00\u5417\uFF1F";return h.returnValue=d,d};return window.addEventListener("beforeunload",p,!1),window.removeEventListener("beforeunload",p)},[]),(0,g.useEffect)(function(){o==null||o.editor.registerCommand("saveFile",U()(P()().mark(function p(){var v,h;return P()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:h=f==null||(v=f.current)===null||v===void 0?void 0:v.getValue(),r==null||r(h||"");case 2:case"end":return y.stop()}},p)}))),o==null||o.editor.addKeybindingRules([{keybinding:o.KeyMod.WinCtrl|o.KeyCode.KeyS,command:"saveFile",when:"editorTextFocus"},{keybinding:o.KeyMod.CtrlCmd|o.KeyCode.KeyS,command:"saveFile",when:"editorTextFocus"},{keybinding:o.KeyMod.CtrlCmd|o.KeyMod.Shift|o.KeyCode.KeyF,command:"editor.action.formatDocument",when:"editorTextFocus"},{keybinding:o.KeyMod.WinCtrl|o.KeyMod.Shift|o.KeyCode.KeyF,command:"editor.action.formatDocument",when:"editorTextFocus"}])},[o]);var c=function(v,h){f.current=v,i==null||i(v,h)};return(0,e.jsx)(K.ZP,Z()({defaultLanguage:"html",loading:(0,e.jsx)(Q.Z,{}),options:Z()({selectOnLineNumbers:!0,fontSize:14,fontFamily:"Menlo, Monaco, 'Courier New', monospace",readOnly:a},u),onMount:c},l))}var C=n(27128),Pe=n(87740),q=n(38925),F=n(14726),A=n(42075);function ie(t){var u=t.banner,s=u===void 0?!0:u,a=(0,x.useModel)("Design.page"),i=a.approval,r=a.terminateApproval,l=a.updateApproval;return(0,e.jsxs)(e.Fragment,{children:[(0,C.createCondition)([[function(){var o;return(i==null?void 0:i.instanceId)&&(i==null||(o=i.detail)===null||o===void 0?void 0:o.instanceStatus)==="COMPLETED"},function(){return(0,e.jsx)(q.Z,{banner:s,showIcon:!0,type:"success",message:"\u9875\u9762\u53D1\u5E03\u5BA1\u6279\u5DF2\u901A\u8FC7\uFF0C\u70B9\u51FB\u53D1\u5E03\u6309\u94AE\u8FDB\u884C\u7EBF\u4E0A\u53D1\u5E03\uFF0C\u9875\u9762\u5C06\u5728\u518D\u6B21\u53D1\u5E03\u6210\u529F\u540E 3 \u5206\u949F\u5185\u4E0A\u7EBF"})}]]),(0,C.createCondition)([[function(){var o;return(i==null?void 0:i.instanceId)&&(i==null||(o=i.detail)===null||o===void 0?void 0:o.instanceStatus)==="RUNNING"},function(){return(0,e.jsx)(q.Z,{banner:s,showIcon:!0,type:"info",action:(0,e.jsx)(F.ZP,{type:"link",size:"small",icon:(0,e.jsx)(Pe.Z,{}),onClick:l,children:"\u5237\u65B0"}),message:(0,e.jsxs)(A.Z,{size:"small",children:["\u9875\u9762\u53D1\u5E03\u6B63\u5728\u5BA1\u6279\u4E2D\uFF0C\u5BA1\u6279\u901A\u8FC7\u540E\u5373\u53EF\u53D1\u5E03\u3002\u4F60\u53EF\u4EE5",(0,e.jsx)(F.ZP,{size:"small",type:"link",href:i==null?void 0:i.url,target:"_blank",children:"\u67E5\u770B\u8FDB\u5EA6"}),"\u6216",(0,e.jsx)(F.ZP,{size:"small",type:"link",danger:!0,onClick:r,children:"\u53D6\u6D88\u5BA1\u6279"})]})})}]])]})}var be=n(5574),G=n.n(be),De=n(45605),Me=n(13923),Be=n(99611),we=n(60219),Te=n(16596),T=n(20600),ke=n(85673),Ie=n(74627),_=n(26412),oe=n(83062),Le=n(9783),H=n.n(Le),Oe=n(93967),ee=n.n(Oe),ae=n(36378),Re=n(73234),ze=n(52012),O={"user-avatar":"user-avatar___Go15Y","user-avatar-clickable":"user-avatar-clickable___th2EQ","small-avatar":"small-avatar___xqRsd","avatar-img":"avatar-img___EKA5Y","middle-avatar":"middle-avatar___HZn9K","large-avatar":"large-avatar___INKp1","square-avatar":"square-avatar___XUsvK","circle-avatar":"circle-avatar___NE3PB","avatar-img-loading":"avatar-img-loading___acmpt","user-avatar-loading":"user-avatar-loading___q7Gsw"},$e=["size","shape","avatarSrc","workId","displayName","realName","nickName","showName","showAvatar","avatarClassName","avatarStyle","className","textStyle","textClassName","format","href","target","onClick"],Ke=T.Z.Text;function W(t){var u=t.size,s=t.shape,a=t.avatarSrc,i=t.workId,r=i===void 0?"":i,l=t.displayName,o=l===void 0?"":l,f=t.realName,c=f===void 0?"":f,p=t.nickName,v=p===void 0?"":p,h=t.showName,d=h===void 0?"":h,y=t.showAvatar,E=t.avatarClassName,k=t.avatarStyle,z=t.className,I=t.textStyle,B=t.textClassName,m=t.format,N=t.href,j=t.target,w=t.onClick,Y=J()(t,$e),D=(0,g.useState)(!1),pe=G()(D,2),ma=pe[0],fa=pe[1],ge=(0,g.useMemo)(function(){return(0,ae.Z)(o)&&o!==""?o:m&&((0,ae.Z)(c)&&c!==""||(0,ae.Z)(v)&&v!=="")?m.replace("%w",r).replace("%r",c).replace("%n",v||c):""},[o,c,v,m,r]),ha=function(){return fa(!0)},xe=N&&N!=="",pa=xe?T.Z.Link:Ke;return(0,e.jsxs)(A.Z,Z()(Z()({},Y),{},{size:"small",align:"center",className:ee()(z,O["user-avatar"],H()(H()(H()({},O["".concat(u,"-avatar")],!0),O["".concat(s,"-avatar")],!0),O["user-avatar-clickable"],(0,Re.Z)(w)||xe)),onClick:w,children:[(0,C.createCondition)([[function(){return y&&r},function(){return(0,e.jsx)("img",{src:a||"https://work.alibaba-inc.com/photo/".concat(r,".80x80.jpg"),alt:r,className:ee()(E,O["avatar-img"],H()({},O["avatar-img-loading"],!ma)),style:k,onLoad:ha})}]]),(0,C.createCondition)([[function(){return d&&!(0,ze.Z)(ge)},function(){return(0,e.jsx)(pa,{className:ee()(B,O["avatar-user-name"]),type:"secondary",href:N,target:j,style:I,children:o||ge})}]])]}))}W.displayName="UserAvatar",W.defaultProps={size:"middle",shape:"circle",showAvatar:!0,showName:!0,format:"%n(%w)",target:"_blank"};var le=n(97280),Ue=n(42178),ue=n(15360),b={titleRow:"titleRow___q2OmV",editor:"editor___XKM6F",publishPanel:"publishPanel___gyPui",publishContent:"publishContent___GuGcJ",steps:"steps___xx6Er",release:"release___mE_T2",prepub:"prepub___hLRgS"},se=T.Z.Text;function Ge(t){var u=t.onConfirm,s=t.onCancel,a=(0,x.useModel)("Design.page"),i=a.unSavedSourceCode,r=a.latestSourceCode,l=r===i;return(0,e.jsxs)(e.Fragment,{children:[(0,C.createCondition)([[function(){return l},function(){return(0,e.jsx)(q.Z,{banner:!0,type:"info",message:"\u5F53\u524D\u7F16\u8F91\u5668\u4E2D\u7684\u4EE3\u7801\u4E0E\u7EBF\u4E0A\u4E00\u81F4"})}]]),(0,e.jsxs)(A.Z,{direction:"vertical",size:"middle",className:b.publishContent,children:[(0,e.jsxs)(S.Z,{className:b.titleRow,align:"center",children:[(0,e.jsxs)(A.Z,{style:{flex:1},children:[(0,e.jsx)(ue.Z,{}),(0,e.jsx)(se,{children:"\u7EBF\u4E0A\u4EE3\u7801"})]}),(0,e.jsxs)(A.Z,{style:{flex:1},children:[(0,e.jsx)(ue.Z,{}),(0,e.jsx)(se,{children:"\u6700\u65B0\u4EE3\u7801"})]})]}),(0,e.jsx)(Se,{className:b.editor,width:"100%",height:"60vh",original:r,modified:i}),(0,e.jsx)(S.Z,{justify:"center",children:(0,e.jsxs)(A.Z,{children:[(0,e.jsx)(F.ZP,{onClick:s,children:"\u8FD4\u56DE"}),(0,e.jsx)(F.ZP,{type:"primary",onClick:u,children:"\u786E\u8BA4\u65E0\u8BEF"})]})})]})]})}var ne=n(71360),X=n(2453),de=n(96074),ce=n(66309),Ve=n(33468),He=n.n(Ve),We=T.Z.Paragraph,Xe=T.Z.Text;function Ye(t){var u=t.onConfirm,s=(0,x.useModel)("Design.page"),a=s.schema,i="https://pre-www.aliyun.com/page-source".concat(a==null?void 0:a.path),r=(0,g.useState)(!1),l=G()(r,2),o=l[0],f=l[1],c=(0,ne.Z)(U()(P()().mark(function h(){var d;return P()().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,He()({id:a==null?void 0:a.id});case 2:d=E.sent,d||X.ZP.error("\u9884\u53D1\u5931\u8D25");case 4:case"end":return E.stop()}},h)})),{manual:!0,onSuccess:function(){f(!0)}}),p=c.run,v=c.loading;return(0,e.jsxs)(S.Z,{className:b.publishContent,vertical:!0,justify:"start",align:"center",children:[(0,e.jsxs)(A.Z,{direction:"vertical",className:b.prepub,children:[(0,e.jsx)(We,{children:"\u9700\u5148\u6267\u884C\u5B8C\u6210\u9884\u53D1\u5E03\u624D\u53EF\u6B63\u5F0F\u53D1\u5E03"}),(0,e.jsxs)(A.Z,{children:[(0,e.jsx)(F.ZP,{type:"primary",disabled:o,loading:v,onClick:p,children:"\u9884\u53D1\u5E03"}),(0,C.createCondition)([[function(){return o},function(){return(0,e.jsx)(F.ZP,{onClick:u,children:"\u4E0B\u4E00\u6B65"},"prepub-success")}]])]})]}),(0,C.createCondition)([[function(){return o},function(){return(0,e.jsxs)("div",{className:b.prepub,children:[(0,e.jsx)(de.Z,{}),(0,e.jsx)(_.Z,{title:"\u9884\u53D1\u5E03\u5B8C\u6210",column:1,items:[{key:"1",label:"\u53D1\u5E03\u7ED3\u679C",children:(0,e.jsx)(ce.Z,{color:"success",children:"\u6210\u529F"})},{key:"2",label:"\u9884\u53D1\u5730\u5740",children:(0,e.jsx)(Xe,{copyable:{tooltips:["\u590D\u5236","\u590D\u5236\u6210\u529F"],text:i},children:(0,e.jsx)("a",{target:"_blank",href:i,rel:"noreferrer",children:i})})}]})]})}]])]})}var Je=n(27601),ve=n(290),Qe=n(59722),qe=n.n(Qe),_e=n(51272),me=n.n(_e),ea=T.Z.Text,aa=T.Z.Paragraph;function na(t){var u,s,a=t.onFinish,i=(0,x.useModel)("Design.page"),r=i.schema,l=i.approval,o=i.updateApproval,f=!(0,Je.Z)(l==null?void 0:l.instanceId)&&((u=l.detail)===null||u===void 0?void 0:u.instanceStatus)!=="COMPLETED",c=(0,g.useState)(!1),p=G()(c,2),v=p[0],h=p[1],d="https://www.aliyun.com/page-source".concat(r==null?void 0:r.path),y=(0,ne.Z)(U()(P()().mark(function B(){var m,N,j,w;return P()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,qe()({id:r==null?void 0:r.id,pageIndex:0,pageSize:1});case 2:if(N=D.sent,!(N!=null&&(m=N.data)!==null&&m!==void 0&&(m=m.list)!==null&&m!==void 0&&m.length)){D.next=6;break}return w=N.data.list[0],D.abrupt("return",(j=/prepub/)===null||j===void 0?void 0:j.test((w==null?void 0:w.method)||""));case 6:return D.abrupt("return",!0);case 7:case"end":return D.stop()}},B)})),{ready:(0,ve.Z)(r==null?void 0:r.id)}),E=y.data,k=(0,ne.Z)(U()(P()().mark(function B(){var m;return P()().wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,me()({id:r==null?void 0:r.id});case 2:if(m=j.sent,m){j.next=5;break}throw new Error("\u53D1\u5E03\u5931\u8D25");case 5:if((m==null?void 0:m.code)!=="APPROVAL_START"){j.next=7;break}throw new Error((m==null?void 0:m.error)||"\u5BA1\u6279\u5F00\u59CB\uFF0C\u8BF7\u7B49\u5F85\u5BA1\u6279\u5B8C\u6210",{cause:m.code});case 7:return j.abrupt("return",!0);case 8:case"end":return j.stop()}},B)})),{manual:!0,ready:(0,ve.Z)(r==null?void 0:r.id),onSuccess:function(){h(!0)},onError:function(m){if(m.cause==="APPROVAL_START"){o();return}X.ZP.error((m==null?void 0:m.message)||"\u53D1\u5E03\u5931\u8D25")}}),z=k.run,I=k.loading;return(0,e.jsxs)(S.Z,{vertical:!0,className:b.publishContent,justify:"start",align:"center",children:[(0,e.jsxs)(A.Z,{direction:"vertical",className:b.release,children:[(0,e.jsx)(ie,{banner:!1}),(0,C.createCondition)([[function(){return!l&&!v},function(){return(0,e.jsx)(aa,{children:"\u82E5\u6709\u5FC5\u8981\uFF0C\u53D1\u5E03\u65F6\u5C06\u81EA\u52A8\u521B\u5EFA\u5BA1\u6279\u6D41, \u5BA1\u6279\u901A\u8FC7\u540E\u65B9\u53EF\u53D1\u5E03"})}]]),(0,e.jsxs)(A.Z,{children:[(0,e.jsx)(oe.Z,{title:(l==null||(s=l.detail)===null||s===void 0?void 0:s.instanceStatus)==="RUNNING"?"\u9700\u5148\u5BA1\u6279\u901A\u8FC7":void 0,children:(0,e.jsx)(F.ZP,{type:"primary",loading:I,disabled:f||!E||v,onClick:z,children:"\u7EBF\u4E0A\u53D1\u5E03"})}),(0,C.createCondition)([[function(){return v},function(){return(0,e.jsx)(F.ZP,{onClick:a,children:"\u5B8C\u6210"})}]])]})]}),(0,C.createCondition)([[function(){return v},function(){return(0,e.jsxs)("div",{className:b.release,children:[(0,e.jsx)(de.Z,{dashed:!0}),(0,e.jsx)(_.Z,{column:1,title:"\u53D1\u5E03\u5B8C\u6210",items:[{key:"1",label:"\u53D1\u5E03\u7ED3\u679C",children:(0,e.jsx)(ce.Z,{color:"success",children:"\u6210\u529F"})},{key:"2",label:"\u7EBF\u4E0A\u5730\u5740",children:(0,e.jsx)(ea,{copyable:{tooltips:["\u590D\u5236","\u590D\u5236\u6210\u529F"],text:d},children:(0,e.jsx)("a",{target:"_blank",href:d,rel:"noreferrer",children:d})})}]})]})}]])]})}var ta=[{title:"\u53D8\u66F4\u786E\u8BA4"},{title:"\u9884\u53D1\u5E03"},{title:"\u7EBF\u4E0A\u53D1\u5E03"}];function ra(t){var u=(0,g.useState)(0),s=G()(u,2),a=s[0],i=s[1],r=t.onCancel,l=t.open,o=(0,x.useModel)("Design.page"),f=o.approval;return(0,g.useEffect)(function(){l&&f!==null&&f!==void 0&&f.instanceId&&i(2)},[f==null?void 0:f.instanceId,l]),(0,e.jsx)(le.Z,Z()(Z()({title:"\u6E90\u7801\u53D1\u5E03",width:"70vw",centered:!0,maskClosable:!1,footer:!1,okText:"\u786E\u8BA4\u65E0\u8BEF\uFF0C\u9884\u53D1\u5E03",cancelText:"\u53D6\u6D88",afterClose:function(){return i(0)}},t),{},{children:(0,e.jsxs)(A.Z,{direction:"vertical",size:"middle",style:{width:"100%"},children:[(0,e.jsx)(S.Z,{justify:"center",align:"center",children:(0,e.jsx)(Ue.Z,{className:b.steps,size:"small",current:a,items:ta})}),(0,C.createCondition)([[function(){return a===0},function(){return(0,e.jsx)(Ge,{onConfirm:function(){return i(1)},onCancel:r})}]]),(0,C.createCondition)([[function(){return a===1},function(){return(0,e.jsx)(Ye,{onConfirm:function(){return i(2)}})}]]),(0,C.createCondition)([[function(){return a===2},function(){return(0,e.jsx)(na,{onFinish:r})}]])]})}))}var V={logo:"logo___l4oF_",page:"page___QsnxW",header:"header___YKw5Z",siteName:"siteName___W_Ae9",editor:"editor___DI0Mn"},fe=T.Z.Text,ia=M.Z.Header,he={tooltips:["\u590D\u5236","\u590D\u5236\u6210\u529F"],format:"text/plain"};function oa(){var t=(0,x.useAccess)(),u=t.canEdit,s=(0,x.useModel)("Design.page"),a=s.schema,i=s.loadingSchema,r=s.refresh,l=s.saveSourceCode,o=s.savingSourceCode,f=(0,x.useModel)("Design.site"),c=f.site,p=f.loading,v=(0,x.useModel)("Design.channel"),h=v.channel,d=v.loading,y=(0,g.useState)(!1),E=G()(y,2),k=E[0],z=E[1],I=!i&&(a==null?void 0:a.id),B=u,m=!i&&!p&&!d&&(a==null?void 0:a.id),N="https://pre-www.aliyun.com/page-source".concat(a==null?void 0:a.path),j="https://www.aliyun.com/page-source".concat(a==null?void 0:a.path),w=[{key:1,label:"\u9884\u53D1\u5730\u5740",children:(0,e.jsx)(fe,{copyable:Z()(Z()({},he),{},{text:N}),children:(0,e.jsx)("a",{target:"_blank",href:N,rel:"noreferrer",children:N})})},{key:2,label:"\u7EBF\u4E0A\u5730\u5740",children:(0,e.jsx)(fe,{copyable:Z()(Z()({},he),{},{text:j}),children:(0,e.jsx)("a",{target:"_blank",href:j,rel:"noreferrer",children:j})})},{key:3,label:"\u521B\u5EFA\u8005",children:(0,e.jsx)(W,{workId:a==null?void 0:a.creatorWorkId,displayName:a==null?void 0:a.creator,href:"https://work.aliyun-inc.com/nwpipe/u/".concat(a==null?void 0:a.creatorWorkId)})}];return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(ia,{className:V.header,children:[(0,e.jsxs)(S.Z,{align:"center",justify:"start",gap:"middle",children:[(0,e.jsxs)(S.Z,{justify:"start",align:"center",gap:"small",children:[(0,e.jsx)("img",{className:V.logo,src:"https://img.alicdn.com/tfs/TB1R3ypVNv1gK0jSZFFXXb0sXXa-80-80.png",alt:"homon"}),(0,e.jsx)("h1",{className:V.siteName,children:(0,e.jsx)("a",{href:"/",children:"\u9E3F\u8499\u6E90\u7801"})})]}),(0,C.createCondition)([[function(){return m},function(){return(0,e.jsx)(ke.Z,{items:[{title:(0,e.jsx)("a",{href:"/sites/".concat(c==null?void 0:c.id),target:"blank",children:c==null?void 0:c.name})},{title:(0,e.jsx)("a",{href:"/channels/".concat(h==null?void 0:h.id),target:"blank",children:h==null?void 0:h.name})},{title:a==null?void 0:a.name}]})}]]),(0,e.jsx)(Q.Z,{spinning:i,size:"small"})]}),(0,e.jsxs)(S.Z,{justify:"space-between",align:"center",gap:"small",children:[(0,e.jsx)(Ie.Z,{trigger:"click",content:(0,e.jsx)(_.Z,{bordered:!0,size:"small",style:{width:700},column:1,items:w}),children:(0,e.jsx)(F.ZP,{icon:(0,e.jsx)(De.Z,{}),children:"\u4FE1\u606F"})}),(0,C.createCondition)([[function(){return I},function(){return(0,e.jsx)(F.ZP,{icon:(0,e.jsx)(Me.Z,{}),href:"/pages/".concat(a==null?void 0:a.id,"/history"),target:"_blank",children:"\u5386\u53F2"})}]]),(0,C.createCondition)([[function(){return I},function(){return(0,e.jsx)(F.ZP,{disabled:!u,icon:(0,e.jsx)(Be.Z,{}),href:"/preview/".concat(a==null?void 0:a.id),target:"_blank",children:"\u9884\u89C8"})}]]),(0,C.createCondition)([[function(){return I},function(){return(0,e.jsx)(F.ZP,{disabled:!B,loading:o,icon:(0,e.jsx)(we.Z,{}),onClick:l,children:"\u4FDD\u5B58"})}]]),(0,e.jsx)(oe.Z,{title:(0,C.createCondition)([[function(){return!u},function(){return(0,e.jsxs)(A.Z,{size:"small",align:"center",children:["\u60A8\u65E0\u53D1\u5E03\u6743\u9650,\u8BF7\u8054\u7CFB:",(0,e.jsx)(W,{target:"_blank",size:"small",href:"https://work.alibaba-inc.com/nwpipe/u/".concat(a==null?void 0:a.creatorWorkId),workId:a==null?void 0:a.creatorWorkId,displayName:a==null?void 0:a.creator,textStyle:{color:"#fff"}})]})}]]),children:(0,C.createCondition)([[function(){return I},function(){return(0,e.jsx)(F.ZP,{disabled:!u||o,type:"primary",icon:(0,e.jsx)(Te.Z,{}),onClick:function(){return z(!0)},children:"\u53D1\u5E03"})}]])})]})]}),(0,e.jsx)(ra,{open:k,onCancel:function(){r(),z(!1)}})]})}var la=`<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="data-spm" content="5176" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>\u963F\u91CC\u4E91</title>
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <script type="text/javascript" src="//www.aliyun.com/rgn/aliyun_assets?renderer=js"><\/script>
    <!-- Polyfills -->
    <!--[if lt IE 10]>
      <script src="//g.alicdn.com/aliyun/static/0.0.11/polyfill-ie.js"><\/script>
    <![endif]-->
    <script src="//g.alicdn.com/aliyun/static/0.0.11/polyfill-es6.js"><\/script>
  </head>

  <body data-spm="">
    <script type="text/javascript" src="//www.aliyun.com/rgn/aliyun_topbar/index.js"><\/script>
    \u4E0A\u4E91\u5C31\u4E0A\u963F\u91CC\u4E91\uFF01
    <script type="text/javascript" src="//www.aliyun.com/rgn/aliyun_footer?renderer=js"><\/script>
  </body>
</html>
`,te=function(t){return t.PASS="CHANGE_PASS",t.CANCEL="CHANGE_CANCEL",t.APPROVING="CHANGE_DEALING",t.REFUSE="CHANGE_REFUSE",t}({});function ua(){var t=(0,x.useModel)("Design.page"),u=t.schema,s=t.changeFreeManagement,a=s||{},i=a.orderUrl,r=a.status;(0,g.useEffect)(function(){if(r&&i&&u!==null&&u!==void 0&&u.id){var l;switch(r){case te.PASS:l={type:"success",title:"[ChangeFree]\u5BA1\u6279\u901A\u8FC7",content:"\u8BF7\u76F4\u63A5\u6B63\u5F0F\u53D1\u5E03\u9875\u9762,\u4EFB\u4F55\u5176\u4ED6\u64CD\u4F5C\u90FD\u9700\u8981\u518D\u6B21\u5BA1\u6279",okText:"\u76F4\u63A5\u53D1\u5E03",okButtonProps:{type:"primary"},onOk:function(){return U()(P()().mark(function f(){return P()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",new Promise(function(v,h){me()({id:u==null?void 0:u.id}).then(function(d){if(d.data===!0)X.ZP.success("\u53D1\u5E03\u6210\u529F"),v(!0);else{if("".concat(d.code)!=="200")throw new Error(d==null?void 0:d.error,{cause:d==null?void 0:d.code});v(!0)}}).catch(function(d){X.ZP.error((d==null?void 0:d.message)||"\u53D1\u5E03\u5931\u8D25"),h(d)})}));case 1:case"end":return p.stop()}},f)}))()}};break;case te.REFUSE:l={type:"error",title:"[ChangeFree]\u5BA1\u6279\u88AB\u51B3\u7EDD",content:"\u8BF7\u67E5\u770B\u5BA1\u6279\u539F\u56E0",okText:"\u67E5\u770B\u62D2\u7EDD\u539F\u56E0",okButtonProps:{type:"primary",target:"_blank",href:i}};break;case te.APPROVING:l={type:"confirm",title:"[ChangeFree]\u5BA1\u6279\u4E2D",content:"\u9875\u9762\u6B63\u5728\u5BA1\u6279\u4E2D\uFF0C\u5728\u5BA1\u6279\u901A\u8FC7\uFF08\u6216\u53D6\u6D88\uFF09\u524D\u4E0D\u8981\u8FDB\u884C\u4EFB\u4F55\u64CD\u4F5C\uFF0C\u5176\u4ED6\u4EFB\u4F55\u64CD\u4F5C\uFF08\u5305\u62EC\u9884\u53D1\uFF09\u90FD\u9700\u8981\u518D\u6B21\u5BA1\u6279",cancelText:"\u6211\u77E5\u9053\u4E86",okText:"\u67E5\u770B\u5BA1\u6279\u8FDB\u5C55",okButtonProps:{type:"primary",target:"_blank",href:i}};break;default:}l&&le.Z[l.type](Z()({},l))}},[i,r,u==null?void 0:u.id])}var sa=n(16568);function da(){var t=(0,x.useModel)("@@initialState"),u=t.initialState,s=u.isLock,a=u.lockData;(0,g.useEffect)(function(){if(s){var i,r;sa.ZP.info({title:"\u9875\u9762\u7F16\u8F91\u5DF2\u9501\u5B9A",message:"\u5F53\u524D\u9875\u9762\u5DF2\u88AB\u9501\u5B9A\uFF0C\u8BF7\u8054\u7CFB @".concat(a==null||(i=a.user)===null||i===void 0?void 0:i.name,"(").concat(a==null||(r=a.user)===null||r===void 0?void 0:r.workId,") \u89E3\u9501")})}},[s])}var ca=M.Z.Content;function va(){var t,u=(0,x.useParams)(),s=(0,L.Z)(u.pageId),a=(0,x.useAccess)(),i=a.canEdit,r=(0,x.useModel)("Design.page"),l=r.schema,o=r.approval,f=r.loadSchema,c=r.setUnSavedSourceCode,p=r.loadingSchema,v=r.saveSourceCode,h=r.unSavedSourceCode,d=r.savingSourceCode;(0,g.useEffect)(function(){isNaN(s)||f(s)},[s]),ua(),da();var y=(0,g.useMemo)(function(){var E;return JSON.parse((l==null||(E=l.pcVO)===null||E===void 0?void 0:E.plugins)||"{}")},[l==null||(t=l.pcVO)===null||t===void 0?void 0:t.plugins]);return(0,g.useEffect)(function(){!l||p?c("\u6E90\u7801\u52A0\u8F7D\u4E2D..."):l!=null&&l.id&&!(y!=null&&y.xtpl)?c(la):c(y==null?void 0:y.xtpl)},[y==null?void 0:y.xtpl,p]),(0,e.jsxs)(M.Z,{className:V.page,children:[(0,e.jsx)(oa,{}),(0,e.jsx)(ca,{children:(0,e.jsxs)(S.Z,{vertical:!0,gap:12,style:{height:"100%",background:"#fff"},children:[(0,e.jsx)(ie,{}),(0,e.jsx)(Ae,{className:V.editor,readOnly:!i||p||d||!!(o!=null&&o.instanceId),value:h,onChange:c,onSave:v,onValidate:function(k){console.log(k)}})]})})]})}},33468:function(R,$,n){var g=n(15762),x=n(53101);R.exports=function(M,S,L){return x(g,"https://homon.aliyun-inc.com/yamlql?src.services.page.prepub",{data:{action:"page.prepub",params:["$id","$languages"]}},M,S,L)}},59722:function(R,$,n){var g=n(15762),x=n(53101);R.exports=function(M,S,L){return x(g,"https://homon.aliyun-inc.com/yamlql?src.services.page.queryOperationLogs",{data:{action:"page.queryOperationLogs",params:["$id","$pageIndex","$pageSize"]}},M,S,L)}},51272:function(R,$,n){var g=n(15762),x=n(53101);R.exports=function(M,S,L){return x(g,"https://homon.aliyun-inc.com/yamlql?src.services.page.release",{data:{action:"page.release",params:["$id","$languages"]}},M,S,L)}}}]);
